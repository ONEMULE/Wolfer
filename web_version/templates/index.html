<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Web-based configuration tool for Weather Research and Forecasting (WRF) Model. Generate namelist.wps and namelist.input files with guided setup.">
    <meta name="keywords" content="WRF, Weather Model, Atmospheric Simulation, Namelist Generator">
    <meta name="author" content="WRF Configuration Team">
    <title>WRF Namelist Generator - Web Configuration Interface</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <!-- Open Graph tags for social sharing -->
    <meta property="og:title" content="WRF Namelist Generator">
    <meta property="og:description" content="Web-based configuration tool for Weather Research and Forecasting Model">
    <meta property="og:type" content="website">
</head>
<body>
    <div class="container">
        <header>
            <h1>WRF Namelist Generator</h1>
            <p class="lead">Advanced configuration tool for Weather Research and Forecasting Model</p>
        </header>
        
        <!-- Step Navigation -->
        <div class="steps-nav">
            <div class="step-item active" data-step="1">1</div>
            <div class="step-item" data-step="2">2</div>
            <div class="step-item" data-step="3">3</div>
            <div class="step-item" data-step="4">4</div>
            <div class="step-item" data-step="5">5</div>
        </div>
        
        <div class="steps-content">
            <!-- Step 1: Simulation Period -->
            <div class="step-page active" id="step-1">
                <div class="card">
                    <h2 class="card-title">Simulation Period</h2>
                    <p>Define the time span for your WRF simulation. This determines the start and end dates for your forecast or analysis.</p>
                    
                    <div class="form-group">
                        <label for="start_date" class="form-label">Start Date (YYYY-MM-DD_HH:MM:SS)</label>
                        <input type="text" class="form-control" id="start_date" name="start_date" value="{{ config.start_date }}">
                    </div>
                    
                    <div class="form-group">
                        <label for="end_date" class="form-label">End Date (YYYY-MM-DD_HH:MM:SS)</label>
                        <input type="text" class="form-control" id="end_date" name="end_date" value="{{ config.end_date }}">
                    </div>
                    
                    <div class="alert alert-info">
                        The simulation period directly impacts computational resources needed and the accuracy of your forecast.
                    </div>
                    
                    <div class="btn-group">
                        <div></div>
                        <button type="button" class="btn btn-primary next-step" data-next="2">Next: Domain Setup</button>
                    </div>
                </div>
            </div>
            
            <!-- Step 2: Domain Setup -->
            <div class="step-page" id="step-2">
                <div class="card">
                    <h2 class="card-title">Domain Setup</h2>
                    <p>Configure the spatial characteristics of your WRF model domain including resolution, projection, and nesting.</p>
                    
                    <div class="form-group">
                        <label for="projection" class="form-label">Map Projection</label>
                        <select class="form-select" id="projection" name="projection">
                            {% for id, name in projections.items() %}
                                <option value="{{ id }}" {% if config.projection == id|int %}selected{% endif %}>{{ name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="max_dom" class="form-label">Number of Domains</label>
                        <select class="form-select" id="max_dom" name="domain.max_dom">
                            {% for i in range(1, 4) %}
                                <option value="{{ i }}" {% if config.domain.max_dom == i %}selected{% endif %}>{{ i }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="row">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="e_we" class="form-label">E-W Grid Points</label>
                            <input type="number" class="form-control" id="e_we" name="domain.e_we" value="{{ config.domain.e_we }}">
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="e_sn" class="form-label">N-S Grid Points</label>
                            <input type="number" class="form-control" id="e_sn" name="domain.e_sn" value="{{ config.domain.e_sn }}">
                        </div>
                    </div>
                    
                    <div class="row" style="clear: both;">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="dx" class="form-label">DX (km)</label>
                            <input type="number" step="0.1" class="form-control" id="dx" name="domain.dx" value="{{ config.domain.dx }}">
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="dy" class="form-label">DY (km)</label>
                            <input type="number" step="0.1" class="form-control" id="dy" name="domain.dy" value="{{ config.domain.dy }}">
                        </div>
                    </div>
                    
                    <div class="row" style="clear: both;">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="ref_lat" class="form-label">Reference Latitude</label>
                            <input type="number" step="0.1" class="form-control" id="ref_lat" name="domain.ref_lat" value="{{ config.domain.ref_lat }}">
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="ref_lon" class="form-label">Reference Longitude</label>
                            <input type="number" step="0.1" class="form-control" id="ref_lon" name="domain.ref_lon" value="{{ config.domain.ref_lon }}">
                        </div>
                    </div>
                    
                    <div class="row" style="clear: both;">
                        <div class="form-group" style="width: 100%;">
                            <label for="stand_lon" class="form-label">Standard Longitude</label>
                            <input type="number" step="0.1" class="form-control" id="stand_lon" name="domain.stand_lon" value="{{ config.domain.stand_lon }}">
                        </div>
                    </div>
                    
                    <div class="row" style="clear: both;">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="truelat1" class="form-label">True Latitude 1</label>
                            <input type="number" step="0.1" class="form-control" id="truelat1" name="domain.truelat1" value="{{ config.domain.truelat1 }}">
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="truelat2" class="form-label">True Latitude 2</label>
                            <input type="number" step="0.1" class="form-control" id="truelat2" name="domain.truelat2" value="{{ config.domain.truelat2 }}">
                        </div>
                    </div>
                    
                    <div class="alert alert-info" style="clear: both;">
                        For multi-domain setup, parent grid ratios and starting locations are set automatically based on best practices.
                    </div>
                    
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary prev-step" data-prev="1">Previous</button>
                        <button type="button" class="btn btn-primary next-step" data-next="3">Next: Physics Options</button>
                    </div>
                </div>
            </div>
            
            <!-- Step 3: Physics Options -->
            <div class="step-page" id="step-3">
                <div class="card">
                    <h2 class="card-title">Physics Options</h2>
                    <p>Select the physical parameterization schemes for your simulation.</p>
                    
                    <div class="row">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="mp_physics" class="form-label">Microphysics Scheme</label>
                            <select class="form-select" id="mp_physics" name="physics.mp_physics">
                                {% for id, name in physics_options.mp_physics.items() %}
                                    <option value="{{ id }}" {% if config.physics.mp_physics == id|int %}selected{% endif %}>{{ name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="cu_physics" class="form-label">Cumulus Scheme</label>
                            <select class="form-select" id="cu_physics" name="physics.cu_physics">
                                {% for id, name in physics_options.cu_physics.items() %}
                                    <option value="{{ id }}" {% if config.physics.cu_physics == id|int %}selected{% endif %}>{{ name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    
                    <div class="row" style="clear: both;">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="ra_lw_physics" class="form-label">Longwave Radiation Scheme</label>
                            <select class="form-select" id="ra_lw_physics" name="physics.ra_lw_physics">
                                {% for id, name in physics_options.ra_lw_physics.items() %}
                                    <option value="{{ id }}" {% if config.physics.ra_lw_physics == id|int %}selected{% endif %}>{{ name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="ra_sw_physics" class="form-label">Shortwave Radiation Scheme</label>
                            <select class="form-select" id="ra_sw_physics" name="physics.ra_sw_physics">
                                {% for id, name in physics_options.ra_sw_physics.items() %}
                                    <option value="{{ id }}" {% if config.physics.ra_sw_physics == id|int %}selected{% endif %}>{{ name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    
                    <div class="row" style="clear: both;">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="sf_surface_physics" class="form-label">Surface Layer Scheme</label>
                            <select class="form-select" id="sf_surface_physics" name="physics.sf_surface_physics">
                                {% for id, name in physics_options.sf_surface_physics.items() %}
                                    <option value="{{ id }}" {% if config.physics.sf_surface_physics == id|int %}selected{% endif %}>{{ name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="bl_pbl_physics" class="form-label">PBL Scheme</label>
                            <select class="form-select" id="bl_pbl_physics" name="physics.bl_pbl_physics">
                                {% for id, name in physics_options.bl_pbl_physics.items() %}
                                    <option value="{{ id }}" {% if config.physics.bl_pbl_physics == id|int %}selected{% endif %}>{{ name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    
                    <div class="alert alert-info" style="clear: both;">
                        The choice of physics schemes greatly impacts simulation results. Carefully consider which schemes are appropriate for your region and application.
                    </div>
                    
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary prev-step" data-prev="2">Previous</button>
                        <button type="button" class="btn btn-primary next-step" data-next="4">Next: Data Source</button>
                    </div>
                </div>
            </div>
            
            <!-- Step 4: Data Source -->
            <div class="step-page" id="step-4">
                <div class="card">
                    <h2 class="card-title">Data Source</h2>
                    <p>Select the meteorological data to initialize your WRF simulation.</p>
                    
                    <div class="form-group">
                        <label for="data_source" class="form-label">Data Source</label>
                        <select class="form-select" id="data_source" name="data_source">
                            {% for id, name in data_sources.items() %}
                                <option value="{{ id }}" {% if config.data_source == id %}selected{% endif %}>{{ name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div id="era5-settings" class="data-source-settings" style="display: none;">
                        <div class="form-group">
                            <label for="cds_api_key" class="form-label">CDS API Key</label>
                            <input type="text" class="form-control" id="cds_api_key" name="user_settings.cds_api_key" value="{{ config.user_settings.cds_api_key }}">
                        </div>
                        <div class="form-group">
                            <label for="cds_api_url" class="form-label">CDS API URL</label>
                            <input type="text" class="form-control" id="cds_api_url" name="user_settings.cds_api_url" value="{{ config.user_settings.cds_api_url }}">
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        GFS data is freely available with global coverage. ERA5 provides reanalysis data with higher accuracy but requires a CDS API key.
                    </div>
                    
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary prev-step" data-prev="3">Previous</button>
                        <button type="button" class="btn btn-primary next-step" data-next="5">Next: Output Settings</button>
                    </div>
                </div>
            </div>
            
            <!-- Step 5: Settings -->
            <div class="step-page" id="step-5">
                <div class="card">
                    <h2 class="card-title">Output Settings</h2>
                    <p>Configure where files will be stored and specify paths to WRF components.</p>
                    
                    <div class="form-group">
                        <label for="output_dir" class="form-label">Output Directory</label>
                        <input type="text" class="form-control" id="output_dir" name="output_dir" value="{{ config.output_dir }}">
                    </div>
                    
                    <div class="form-group">
                        <label for="geog_data_path" class="form-label">WPS Geography Data Path</label>
                        <input type="text" class="form-control" id="geog_data_path" name="user_settings.geog_data_path" value="{{ config.user_settings.geog_data_path }}">
                    </div>
                    
                    <div class="row">
                        <div class="form-group" style="width: 48%; float: left; margin-right: 4%;">
                            <label for="wps_path" class="form-label">WPS Directory</label>
                            <input type="text" class="form-control" id="wps_path" name="user_settings.wps_path" value="{{ config.user_settings.wps_path }}">
                        </div>
                        <div class="form-group" style="width: 48%; float: left;">
                            <label for="wrf_path" class="form-label">WRF Directory</label>
                            <input type="text" class="form-control" id="wrf_path" name="user_settings.wrf_path" value="{{ config.user_settings.wrf_path }}">
                        </div>
                    </div>
                    
                    <div class="alert alert-info" style="clear: both;">
                        Ensure all directories exist and have appropriate permissions before generating files.
                    </div>
                    
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary prev-step" data-prev="4">Previous</button>
                        <button type="button" id="generate-btn" class="btn btn-primary">Generate WRF Files</button>
                    </div>
                </div>
                
                <!-- Results Section (Initially Hidden) -->
                <div id="result-section" style="display: none;">
                    <div class="card">
                        <h2 class="card-title">Generation Results</h2>
                        
                        <div id="result-messages"></div>
                        
                        <h3>Files Generated Successfully</h3>
                        <p>The following files have been created in your output directory:</p>
                        
                        <div class="file-list">
                            <div class="file-item">
                                <span>namelist.wps</span>
                                <a href="#" class="download-link" data-file="namelist.wps">Download</a>
                            </div>
                            <div class="file-item">
                                <span>namelist.input</span>
                                <a href="#" class="download-link" data-file="namelist.input">Download</a>
                            </div>
                            <div class="file-item">
                                <span>download_data.sh</span>
                                <a href="#" class="download-link" data-file="download_data.sh">Download</a>
                            </div>
                            <div class="file-item">
                                <span>run_wrf.sh</span>
                                <a href="#" class="download-link" data-file="run_wrf.sh">Download</a>
                            </div>
                        </div>
                        
                        <div class="alert alert-info">
                            Output Directory: <span id="output-dir-path"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="/static/js/script.js"></script>
</body>
</html>